<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>encrypt</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script language="JavaScript" type="text/javascript" src="cryptico/jsbn.js"></script>
    <script language="JavaScript" type="text/javascript" src="cryptico/random.js"></script>
    <script language="JavaScript" type="text/javascript" src="cryptico/hash.js"></script>
    <script language="JavaScript" type="text/javascript" src="cryptico/rsa.js"></script>
    <script language="JavaScript" type="text/javascript" src="cryptico/aes.js"></script>
    <script language="JavaScript" type="text/javascript" src="cryptico/api.js"></script>

  </head>
  <body>

    <script>
    var passPhraseFirst;
    var passPhraseSecond;
    var firstPlayerRSAKey;
    var secondPlayerRSAKey;
    var firstPlayerPublicKeyString;
    var secondPlayerPublicKeyString;
    var encryptionResultSecondPlayers;
    var encryptionResultFirstPlayers;

    /*
      THE VAR'S ARE GLOBAL AND CAN BE ACCESSED THAT WAY
    */

    //GENERATES THE FIRST "PLAYER" KEYS
    function generateFirstPlayersKey() {
      var passPhrase = document.getElementById('firstPlayerPassPhrase').value;
      firstPlayerRSAKey = cryptico.generateRSAKey(passPhrase, 512);
      firstPlayerPublicKeyString = cryptico.publicKeyString(firstPlayerRSAKey);
      console.log("1: " + firstPlayerPublicKeyString);

    }
    //GENERATES THE SECOND "PLAYER" KEYS
    function generateSecondPlayersKey() {
      var passPhrase = document.getElementById('secondPlayerPassPhrase').value;
      secondPlayerRSAKey = cryptico.generateRSAKey(passPhrase, 512);
      secondPlayerPublicKeyString = cryptico.publicKeyString(secondPlayerRSAKey);
      console.log("2: " + secondPlayerPublicKeyString);
    }

    //ENCRYPTS SO THAT THE !SECOND! PLAYER SEE THE MSG IN HIS/HERS MESSAGE-BOARD
    function encryptFirstPlayersMessage() {
      var firstPlayerMessage = document.getElementById('firstPlayerMessage').value;
      encryptionResultFirstPlayers = cryptico.encrypt(firstPlayerMessage, firstPlayerPublicKeyString);

      var secondPlayerMessage = document.getElementById('secondPlayerMessage');
      var contentSecondPlayerMessage = document.createTextNode(encryptionResultFirstPlayers.cipher);
      secondPlayerMessage.appendChild(contentSecondPlayerMessage);
    }
    //ENCRYPTS SO THAT THE !FIRST! PLAYER SEE THE MSG IN HIS/HERS MESSAGE-BOARD
    function encryptSecondPlayersMessage() {
      var secondPlayerMessage = document.getElementById('secondPlayerMessage').value;
      encryptionResultSecondPlayers = cryptico.encrypt(secondPlayerMessage, secondPlayerPublicKeyString);

      var firstPlayerMessage = document.getElementById('firstPlayerMessage');
      var contentFirstPlayerMessage = document.createTextNode(encryptionResultSecondPlayers.cipher);
      firstPlayerMessage.appendChild(contentFirstPlayerMessage);
    }

    //DECRYPTES SO THAT THE !FIRST! PLAYER CAN READ THE !SECOND! PLAYERS MSG
    function decryptSecondPlayersMessage() {
      var decryptFirstPlayersMessageResult = cryptico.decrypt(encryptionResultSecondPlayers.cipher, secondPlayerRSAKey);
      var text = decryptFirstPlayersMessageResult.plaintext;
      var firstPlayerMessage = document.getElementById('firstPlayerMessage');
      firstPlayerMessage.innerHTML = "";
      var contentFirstPlayerMessage = document.createTextNode(text);
      firstPlayerMessage.appendChild(contentFirstPlayerMessage);
    }

    //DECRYPTES SO THAT THE !SECOND! PLAYER CAN READ THE !FIRST! PLAYERS MSG
    function decryptFirstPlayersMessage() {
      var decryptSecondPlayersMessageResult = cryptico.decrypt(encryptionResultFirstPlayers.cipher, firstPlayerRSAKey);
      var text = decryptSecondPlayersMessageResult.plaintext;
      var secondPlayerMessage = document.getElementById('secondPlayerMessage');
      secondPlayerMessage.innerHTML = "";
      var contentFirstPlayerMessage = document.createTextNode(text);
      secondPlayerMessage.appendChild(contentFirstPlayerMessage);
    }

    </script>
    <div class="text-center" style="padding: 5%;">
      <h4>First player</h4>
      <input type="text" id="firstPlayerPassPhrase" placeholder="Pass Phrase"/>
      <input type="submit" value="OK" class="btn" onclick="generateFirstPlayersKey()" />

      <h4>Message</h4>
      <textarea id="firstPlayerMessage" rows="8" cols="80"></textarea><br/>
      <input type="submit" class="btn" value="ENCRYPT" onclick="encryptFirstPlayersMessage()"/>
      <input type="submit" class="btn" value="DECRYPT" onclick="decryptSecondPlayersMessage()"/>

    </div>

    <div class="text-center">
      <h4>Second player</h4>

      <input type="text" id="secondPlayerPassPhrase" placeholder="Pass Phrase"/>
      <input type="submit" value="OK" class="btn" onclick="generateSecondPlayersKey()" />

      <h4>Message</h4>
      <textarea id="secondPlayerMessage" rows="8" cols="80"></textarea><br/>
      <input type="submit" value="ENCRYPT" class="btn" onclick="encryptSecondPlayersMessage()" />
      <input type="submit" class="btn" value="DECRYPT" onclick="decryptFirstPlayersMessage()"/>

    </div>
  </body>
</html>
